
    <%- include('../partials/header'); %>
    <body class="vertical-layout vertical-menu 2-columns   menu-expanded fixed-navbar" data-open="click" data-menu="vertical-menu" data-color="bg-chartbg" data-col="2-columns">
            <%- include('../partials/nav'); %>
            <%- include('../partials/left'); %>
        
    <div class="app-content content">
        <div class="content-wrapper">
            <div class="content-body">
                <div class="blocks userDetails">
                    <a href="#">
                        <div class="userIcon">
                            <img src="/assets/images/ic_daily_attendance.png" class="img-fluid" alt="" />
                        </div>
                    </a>
                    <div class="details">
                        <h4 class="m-0">Timeline</h4>
                        <p class="m-0">View the overall Activities of your Employee on a Day to Day Basis.</p>
                    </div>
                    <ul class="d-flex topInputs">
                        <!-- <a href="#" class="downloadButton"><i class="la la-download"></i> Download CSV</a> -->
                        <select class="form-control mr-1">
                            <option>Select Option</option>
                            <option>Option 2</option>
                            <option>Option 3</option>
                            <option>Option 4</option>
                            <option>Option 5</option>
                        </select>
                        <li class="mr-1">
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">
                                        <i class="la la-calendar-o"></i>
                                    </span>
                                </div>
                                <input type="text" class="form-control" placeholder="2021-05-30 - 2021-06-28" aria-label="Username" aria-describedby="basic-addon1">
                            </div>
                        </li>
                        <li>
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="basic-addon1">
                                    <i class="la la-refresh"></i>
                                </span>
                            </div>
                        </li>
                        <!-- <a href="#" data-toggle="modal" data-target="#addProjectModal" class="downloadButton btn-success text-white ml-1 mr-0">
                            Add New Leave
                        </a> -->
                    </ul>
                </div>

                <div class="blocks tabContainers timelineTable mb-0">
                    <div class="table-responsive">
     <table class="table table-striped table-bordered no-wrap" style="min-width:2000px">
     <thead>
     <tr>
                                    <th style="width:200px">User</th>
                                    <th style="width:120px">Worked Hrs.</th>
                                    <th style="width:120px">Productivity</th>
                                    <th>00 AM</th>
                                    <th>02 AM</th>
                                    <th>04 AM</th>
                                    <th>06 AM</th>
                                    <th>08 AM</th>
                                    <th>10 AM</th>
                                    <th>12 AM</th>
                                    <th>02 PM</th>
                                    <th>04 PM</th>
                                    <th>06 PM</th>
                                    <th>08 PM</th>
                                    <th>10 PM</th>
                                </tr>
                            </thead>
                            <tbody> 

<%  if(companyuser.user.length > 0){
   
    for(var i=0; i < companyuser.user.length; i++) { 
        var productivitytime =0;
        var idle =0;
        var total=0;
        var userstring = companyuser.user[i].split('_'); 
        
        %> <% var srr=userstring[1].split(' '); 

     var res = srr[0].substring(0, 1); var nres = srr[1].substring(0, 1);  %> 
        <tr>
            <th class="p-0">
                <span class="firstName bg-dark"><%=res %><%=nres %></span><a href="<%= process.env.APP_URL %>/viewdetail/<%= userstring[0] %>"> <%= userstring[1]; %></a></th>
                                    <td style="padding-left: .5rem !important;">
                                        
                                        <%   for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].username == userstring[1]){ %>
    
                                           <% productivitytime +=companyuser.data[s][0].productivitytime;
                                           idle +=companyuser.data[s][0].idletime;   %>  <%  } } %>




                                        <% var total=productivitytime+idle;  
                                        
                        didletime = Number(total);
                        var hidletime = Math.floor(didletime / 3600);
                        var midletime = Math.floor(didletime % 3600 / 60);
                        var sidletime = Math.floor(didletime % 3600 % 60);
                    var idletimeDisplay = hidletime > 0 ? (hidletime > 9 ? hidletime : "0"+hidletime) + (hidletime == 1 ? "" : "") : "00";
                     var midletimeDisplay = midletime > 0 ? (midletime > 9 ? midletime : "0"+midletime) + (midletime == 1 ? "" : "") : "00";
                    var sidletimeDisplay = sidletime > 0 ? (sidletime > 9 ? sidletime : "0"+sidletime) + (sidletime == 1 ? "" : "") : "00";
                                      
                
                   var idletime=idletimeDisplay+':'+midletimeDisplay+':'+sidletimeDisplay; %>
                <%= idletime; %></td>
                                    <td style="padding-left: .5rem !important;"> 
                            <%  var mstotalworking = Math.floor(productivitytime % 3600 / 60);
                                var mstotalworkingDisplay = mstotalworking > 0 ? (mstotalworking > 9 ? mstotalworking : "0"+mstotalworking) + (mstotalworking == 1 ? "" : "") : "00";
                                    var percentage=(Number(mstotalworkingDisplay)*100)/60; 
                                    percentage=Math.round(percentage); %>
                                    <%= percentage+' %'; %>
                                
                                </td>
                                    <td class="p-0"> 
                                        
                                </td>
                                    <td class="p-0"></td>
                                    <td class="p-0"></td>
                                    <td class="p-0">  <%  for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                        if(companyuser.data[s][0].starttime=="06:00:00" && companyuser.data[s][0].username == userstring[1]){ %>

                                       <%= companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                       <% for(var s=0; s < companyuser.data.length; s++) {  
                                   
                                        if(companyuser.data[s][0].starttime=="07:00:00"  && companyuser.data[s][0].username == userstring[1]){ %>

                                       <%= companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                    </div>
                                    </td>
                                    <td class="p-0">

                                        <%  for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="08:00:00" && companyuser.data[s][0].username == userstring[1]){ %>

                                           <% companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                           <% for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="09:00:00"  && companyuser.data[s][0].username == userstring[1]){ %>

                                           <% companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                           <div class="progress">
                                            <div class="progress-bar bg-danger" role="progressbar" style="width: 4%" aria-valuenow="4" aria-valuemin="0" aria-valuemax="100"></div>
                                    </td>
                                    <td class="p-0">
                                        <% var stotal=0;for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="10:00:00"  && companyuser.data[s][0].username == userstring[1]){ %>

                                           <% companyuser.data[s][0].productivitypercentage;  %>  <%  stotal += companyuser.data[s][0].productivitypercentage; } } %>

                                           <% for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="11:00:00"  && companyuser.data[s][0].username == userstring[1]){ %>

                                           <% companyuser.data[s][0].productivitypercentage; %>  <%  stotal += companyuser.data[s][0].productivitypercentage; } } %>


                                       <!-- <div class="progress">
                                            <div class="progress-bar bg-success" role="progressbar" style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"></div>
                                            <div class="progress-bar bg-warning" role="progressbar" style="width: 20%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>-->
                                          
                                    </td>
                                    <td class="p-0">

                                        <% for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="12:00:00"){ %>

                                           <%= companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                           <% for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="13:00:00"){ %>

                                           <%= companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                           
                                      
                                    </td>
                                    <td class="p-0">
                                        <% for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="14:00:00"){ %>

                                           <%= companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                           <% for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="15:00:00"){ %>

                                           <%= companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                    </td>
                                    <td class="p-0">
                                        <% for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="16:00:00"){ %>

                                           <%= companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                           <% for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="17:00:00"){ %>

                                           <%= companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                    </td>
                                    <td class="p-0">
                                        <% for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="18:00:00"){ %>

                                           <%= companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                           <% for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="19:00:00"){ %>

                                           <%= companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                    </td>
                                    <td class="p-0">
                                        <% for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="20:00:00"){ %>

                                           <%= companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                           <% for(var s=0; s < companyuser.data.length; s++) {  
                                       
                                            if(companyuser.data[s][0].starttime=="21:00:00"){ %>

                                           <%= companyuser.data[s][0].productivitypercentage; %>  <%  } } %>
                                    </td>
                                    <td class="p-0"></td>
                                </tr>
                                <% } } %>
                            </tbody>
                        </table>
                    </div>

                    <div class="timeline_b">
                        <div class="indication"><b>Activity Level</b>
                            <ul>
                                <li><span class="color"></span>0-25%</li>
                                <li><span class="color"></span>26-50%</li>
                                <li><span class="color"></span>51-75%</li>
                                <li><span class="color"></span>76-100%</li>
                            </ul>
                        </div>
                        <div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ////////////////////////////////////////////////////////////////////////////-->




    <%- include('../partials/footer'); %>